<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>METAR Reports - 00MN Weather</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="metar.css">
</head>
<body>
    <!-- Header -->
    <header>
        <h1>METAR Reports</h1>
        <p class="subtitle">Nearby Airport Weather</p>
    </header>

    <!-- Navigation -->
    <nav class="nav-bar">
        <a href="index.html" class="nav-link">← Back to Dashboard</a>
    </nav>

    <!-- Main Container -->
    <main>
        <!-- Last Updated -->
        <div class="last-updated">
            <div class="timestamp-container">
                <div class="timestamp-row">
                    <span class="timestamp-label">Last Fetched:</span>
                    <span id="lastFetched" class="timestamp-value">--</span>
                </div>
                <button id="manualRefresh" class="refresh-btn">Refresh Now</button>
                <div class="refresh-info">
                    Next auto-refresh: <span id="refreshCountdown">--</span>
                </div>
            </div>
        </div>

        <!-- METAR Display Section -->
        <section class="metar-section">
            <div class="metar-container">
                <!-- KFFM - Fergus Falls -->
                <div class="metar-card">
                    <div class="metar-header">
                        <div class="station-info">
                            <h2 class="station-id">KFFM</h2>
                            <p class="station-name">Fergus Falls Municipal Airport</p>
                        </div>
                        <div id="kffm-flight-category" class="flight-category-badge">
                            <span class="category-text">--</span>
                        </div>
                    </div>

                    <div class="metar-raw">
                        <div class="raw-label">RAW METAR:</div>
                        <div id="kffm-raw" class="raw-text">Loading...</div>
                    </div>

                    <div class="metar-decoded">
                        <h3>Decoded Information</h3>
                        <div class="decoded-grid">
                            <div class="decoded-item">
                                <span class="decoded-label">Observation Time:</span>
                                <div class="decoded-value" id="kffm-obs-time">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Wind:</span>
                                <div class="decoded-value" id="kffm-wind">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Visibility:</span>
                                <div class="decoded-value" id="kffm-visibility">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Weather:</span>
                                <div class="decoded-value" id="kffm-weather">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Clouds:</span>
                                <div class="decoded-value" id="kffm-clouds">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Temperature:</span>
                                <div class="decoded-value" id="kffm-temp">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Dewpoint:</span>
                                <div class="decoded-value" id="kffm-dewpoint">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Altimeter:</span>
                                <div class="decoded-value" id="kffm-altimeter">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- KADC - Wadena -->
                <div class="metar-card">
                    <div class="metar-header">
                        <div class="station-info">
                            <h2 class="station-id">KADC</h2>
                            <p class="station-name">Wadena Municipal Airport</p>
                        </div>
                        <div id="kadc-flight-category" class="flight-category-badge">
                            <span class="category-text">--</span>
                        </div>
                    </div>

                    <div class="metar-raw">
                        <div class="raw-label">RAW METAR:</div>
                        <div id="kadc-raw" class="raw-text">Loading...</div>
                    </div>

                    <div class="metar-decoded">
                        <h3>Decoded Information</h3>
                        <div class="decoded-grid">
                            <div class="decoded-item">
                                <span class="decoded-label">Observation Time:</span>
                                <div class="decoded-value" id="kadc-obs-time">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Wind:</span>
                                <div class="decoded-value" id="kadc-wind">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Visibility:</span>
                                <div class="decoded-value" id="kadc-visibility">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Weather:</span>
                                <div class="decoded-value" id="kadc-weather">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Clouds:</span>
                                <div class="decoded-value" id="kadc-clouds">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Temperature:</span>
                                <div class="decoded-value" id="kadc-temp">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Dewpoint:</span>
                                <div class="decoded-value" id="kadc-dewpoint">--</div>
                            </div>
                            <div class="decoded-item">
                                <span class="decoded-label">Altimeter:</span>
                                <div class="decoded-value" id="kadc-altimeter">--</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Flight Category Legend -->
        <section class="legend-section">
            <h3>Flight Category Guide</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-badge vfr">VFR</div>
                    <div class="legend-description">
                        <strong>Visual Flight Rules</strong>
                        <p>Ceiling > 3,000 ft AND Visibility > 5 mi</p>
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-badge mvfr">MVFR</div>
                    <div class="legend-description">
                        <strong>Marginal VFR</strong>
                        <p>Ceiling 1,000-3,000 ft OR Visibility 3-5 mi</p>
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-badge ifr">IFR</div>
                    <div class="legend-description">
                        <strong>Instrument Flight Rules</strong>
                        <p>Ceiling 500-999 ft OR Visibility 1-3 mi</p>
                    </div>
                </div>
                <div class="legend-item">
                    <div class="legend-badge lifr">LIFR</div>
                    <div class="legend-description">
                        <strong>Low IFR</strong>
                        <p>Ceiling < 500 ft OR Visibility < 1 mi</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Safety Disclaimer -->
        <section class="disclaimer">
            <h4>⚠️ Important Safety Notice</h4>
            <p>METAR data is sourced from the Aviation Weather Center (official FAA weather). However, this display system may experience delays, errors, or outages.</p>

            <p>All pilots are responsible for obtaining an official weather briefing from authorized briefing sources (e.g., 1800wxbrief.com, Flight Service, ForeFlight, etc.) prior to flight.</p>

            <p>This service is provided "as-is" for informational purposes only. Always verify current conditions and make your own independent judgment regarding flight safety.</p>

            <p><strong>USE AT YOUR OWN RISK.</strong> The operator assumes no liability for decisions made using this information.</p>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <p>Data source: <a href="https://aviationweather.gov" target="_blank" rel="noopener">Aviation Weather Center</a></p>
    </footer>

    <!-- Load Supabase client from CDN (UMD bundle) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>

    <!-- Load configuration -->
    <script src="config.js"></script>

    <!-- Our application script -->
    <script src="metar.js"></script>
</body>
</html>
